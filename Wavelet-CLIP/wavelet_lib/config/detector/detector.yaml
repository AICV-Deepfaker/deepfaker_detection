# log dir
log_dir: ./logs_debug/clip_wavelet

# ──────────────────────────────────────────────────────────────
# 3차 학습 — 처음부터 (checkpoint 없음)
# 핵심 변경: Focal Loss → WeightedCrossEntropy (캘리브레이션 안정화)
#           backbone_trainable_layers: 2 → 4 (더 많은 적응)
#           nEpochs: 8 → 12 (충분한 수렴)
#           lr: 1e-5 → 5e-6 (더 많은 레이어 열리므로 안정적으로)
# ──────────────────────────────────────────────────────────────

# model setting
pretrained: null         # 처음부터 학습
model_name: clip_wavelet
backbone_name: vit
backbone_trainable_layers: 4   # 마지막 4개 레이어 학습 (2→4)

#backbone setting
backbone_config:
  mode: original
  num_classes: 2
  inc: 3
  dropout: false

# dataset
all_dataset: [GAN-DIFFUSION]
train_dataset: [GAN-DIFFUSION]
test_dataset: [GAN-DIFFUSION]
dataset_json_folder: /content/Wavelet-CLIP/preprocessing/dataset_json/GAN_DIFFUSION.json
dataset_name: GAN-DIFFUSION
dataset_roots:
  gan-dataset: /content/gan-dataset
  diffusion-dataset: /content/diffusion-dataset
  wild-deepfake: /content/wild-deepfake

with_mask: false
with_landmark: false

label_dict:
  real: 0
  fake: 1

compression: c23
train_batchSize: 8
test_batchSize: 4
workers: 2
frame_num:
  train: 16
  test: 16
resolution: 224

# data augmentation
use_insightface: true
use_data_augmentation: true
data_aug:
  flip_prob: 0.5
  rotate_prob: 0.5
  rotate_limit: [-10, 10]

# mean and std for normalization
mean: [0.5, 0.5, 0.5]
std: [0.5, 0.5, 0.5]

# optimizer config
optimizer:
  type: adam
  adam:
    lr: 0.000005     # 5e-6: backbone 4레이어 열리므로 안정적 LR
    beta1: 0.9
    beta2: 0.999
    eps: 0.00000001
    weight_decay: 0.0005
    amsgrad: false
  sgd:
    lr: 0.0002
    momentum: 0.9
    weight_decay: 0.0005

# training config
lr_scheduler: cosine
lr_T_max: 12
lr_eta_min: 0.00000005
nEpochs: 12
start_epoch: 1
save_epoch: 2
rec_iter: 100
logdir: ./logs
manualSeed: 1024
save_ckpt: true
save_feat: false

# ──────────────────────────────────────────────────────────────
# loss function
# [변경] focal → weighted_cross_entropy
#
# WeightedCrossEntropy 장점:
#   직접적인 클래스 가중치 → Fake 패널티 8배
#   확률 캘리브레이션 안정 → threshold가 0.3~0.5 범위로 정상화
# ──────────────────────────────────────────────────────────────
loss_func: weighted_cross_entropy
class_weights: [1.0, 8.0]   # [real_weight, fake_weight] — Fake 8배 패널티
losstype: null

# metric
metric_scoring: auc

# cuda
cuda: true
cudnn: true
